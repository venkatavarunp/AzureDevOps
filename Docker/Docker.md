# Docker
## Docker Engine
Docker Engine helps us to run the containers within the server environment
## Docker Hub
Docker Hub is a registry and within this we have repositories

when we pull an image we are actually pulling the image from the deocker repository that was held on Docker hub.
## Docker Official Repositories
these are set of official repositories hosted on the Docker hub that are designed to offer a few specific use cases

These provide drop in solution for popular programming langugaes, runtimes, data stores and other services similar to a `PaaS` offering

These also exemplify the `Dockerfile` best practices and provides clear documentation to serve as a refernce point for other `Dockerfile` authors.

they also ensure security updates have been applied in a timely manner
## Docker Images
to see any installed images in the machine we can use 
```
docker images 
```
to get a image we use 
```
docker pull ubuntu:16.04
```
During pulling of the above image we can see multiple pulls taking place and they are docker image layers.Images on docker can be composed of several layers.

we can use `--no-trunc` to get the full image id of an image 
```
docker images --no-trunc
```
## Dockerfile 
we can build an custom image using `Dockerfile`
```
#DockerFile 

FROM ubuntu:16.04
RUN apt-get update
RUN apt-get install -y python3
```
we use ubuntu:16.04 as a base image and we install python as an another layer to the image.

While creating each layer docker creates a temporary image id for each layer and caches them.

we can build the image from `Dockerfile` by
```
# . indicates that we can use the Dockerfile in the current directory

docker build .
```
## Containers 
the command `docker run` is a legacy command and `docker contianer run` is the replacement of it same as `docker image ls` for `docker images`

we can create and interact with containers using 
```
docker container run -it --name python-container 31
```
`-i` flag is used for interactive, `-t` is used so that we can allocate a sudo TTY

`--name` names the container
we can pass entire image id but instead of we have passed the the first 2 values of image id
## Container Life Cycle
to list the docker containers we use 
```
docker container ls
```
to list the containers the are stopped we use 
```
docker container ls -a
```
to start a container we can use container name or container id
```
docker container start python-container
```
to get into the container we can use 
```
docker attach python-container
```
to delete containers we can use 
```
docker container rm python-container
```
## Container Management
we can login to docker hub using 
```
docker login
```
we can assign the tagname to images using 
```
docker tag ddc1a80b20d8 practice/pythonimage:v1
```
we can push the image to the docker hub using 
```
docker push practice/pythonimage:v1
```
we can delete the image using 
```
docker rmi practice/pythonimage:v1
```
we can get the image from the docker hub using  
```
docker pull #repository name/#image name 

docker pull dockerpracticeacg/pythonimage:v1 
```
## Contianer Ports 
we can get any image from the docker hub by
```
docker container run -d nginx
```
By default nginx has port 80 exposed to interact 

### Exposing a Port
Expose opens up and exposes port inside of the container and makes it available to localhost and internal services. we can make use of services like ELinks to connect to the container on port 80
### Publishing a Port 
In this both host and container port can be speciifed and can be linked to one and another so that we have accessibility to the container from the outside world/

to view which ports are exposed for a container we can use 
```
docker image history nginx
```
we can find the port in the expose section

To get the IPAddress of the container we can use 
```
docker container inspect #container ID | grep IPAdd 
```
grep helps to get matching patterns

we can change the port that localhost listens for a ngnix using
```
docker container run -d -p nginx 
```
- `P` automatically asssigns port number and maps to the port 80 of the container 
we can specify the port by 
```
docker container run -d -p 80:80 httpd
```
we can get the ipv4 address using 
```
curl -4 icanhazip.com 
```
## Docker Volumes 
Docker Volumes are preferred mechanism for persisting data thats generated by a container or thats generated to be used by the containers.

we can use them on both linux and windows containers and we can use volume drivers to store volumes on a remote host or even a cloud provider.

we can create volumes using
```
docker volume create devvolume
```
to get more deatils 
```
 docker volume inspect devvolume
```
to mount a volume to a container we can use 
```
docker container run -d --name devcon --mount source=devvolume,target=/app nginx 
```
we have mounted the devvolume to the /app and we can verify it by looking at the folder or by inspecting the container 
```
sudo ls /var/lib/docker/volumes/devvolume/_data
```
as it is empty we can add something from the container and can see it reflecting in the volume 

we can execute commands in container using 
```
docker container exec -it devcon sh 
```
we can create a file in container using 
``` 
echo "hello!" >> /app/hello.txt
```
we can see the changes reflecting in the volume
```
sudo ls /var/lib/docker/volumes/devvolume/_data
```
the data will be in the volume even if we delete the container as well 
